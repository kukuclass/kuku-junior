### 2.了解同源策略、了解CORS、CSRF

​	**同源：**如果两个页面的协议，ip,以及端口都相同，则两个页面具有相同的源。

​	**同源策略（SOP）**是浏览器之间标准化的安全措施。在*“原产地”*主要是指*“域”*。它可以防止不同的来源相互交互，以防止通过跨站点脚本（XSS）的漏洞，诸如*跨站点请求伪造*等攻击。这主要是为了保护服务器，因为很多时候服务器可以处理身份验证，cookie，会话等。

​	**跨源资源共享（CORS）**是放松SOP的少数几种技术之一。这通过让“域”告诉浏览器冷却并允许这样的请求。这个“告诉”的事情可以通过传递标题来完成。就像是：

`Access-Control-Allow-Origin: //comma separated allowed origins list, or just *`

​	因此，如果[http://bakery.com](http://bakery.com/)将此标题传递给浏览器，并且创建对[http://bakery.com](http://bakery.com/)的请求的页面出现在源列表中，那么浏览器将允许该请求以及cookie 。

​	根据原则定义的规则1。例如，同一域的不同端口不是同一个源。因此，如果端口不同，浏览器可能会拒绝此请求。

#### AJAX为例

​	**关于安全性问题：（XSS、csrf、cors、jsonp,同源策略）**	

​	Ajax 是无需刷新页面就能从服务器获取数据的一种方法。它的核心对象是XHR，同源策略是ajax的一种约束，它为通信设置了相同的协议，相同的域名，相同的端口。于是，会出现同源之外的资源无法访问。比如，目前的前后端分离项目，前端和后端的服务器是部署在不同端口上，非同源，容易出现跨域问题。

​	有两种方法可以解决这一问题，第一：跨源资源共享CORS；第二：JSONP和图像Ping，但是不如CORS稳妥。

​	**CORS：**cors全称是“资源跨域共享”，它允许浏览器向跨源服务器发送xmlhttprequest请求，从而解决ajax只能同源使用的限制。

​	整个cors通信过程是由浏览器自动完成的，关键在于服务器，只要服务器提供了cors接口，就可以跨源通信。对于简单请求，浏览器直接发出cors请求，即在头信息之中。增加一个origin字段,如：GET/corsHTTP/1.1

```
Origin：[http://api.bob.com](http://api.bob.com/) //次请求的跨源地址，服务器会根据该地址决定是否同意该请求。
```

服务器会返回Access-Control-Allow-Origin该类型字段；

```
Host：api.alice.com
Accept-Language：en-US
Connection：keep-alive
User-Agent：Mozilla/5.0
```

​	**JSONP：**通过引入script标签，直接使用src属性引入外部的url。并对其设置cb函数。在资源加载进来的时候定义好一个函数并与cb函数一个名，并把返回的数据作为参数传入该函数，函数内进行一定的操作，但是如果请求失败，可能无法处理任何错误（至少不是以合理、正常的方式）。

​	**CORS与JSONP比较：**jsonp只适用于get请求，但是它可以支持老式浏览器。而cors不支持老式浏览器，但支持所有类型的HTTP请求。

​	**CSRF：**跨站点请求伪造，未经授权系统有权访问某个资源的情况。为了保证通过XHR访问的URL安全，可以通过验证发送请求者是否有权限访问相应的资源。

​	方法：每一次请求都要附带经过相应算法计算得到的验证码；要求以SSL连接来访问；

​	**XSS：**跨站脚本攻击，即恶意攻击者向web页面里插入恶意攻击脚本代码。

​	解决方案：首先：对请求的数据进行转换和过滤，包含在客户端和服务器端的转换和过滤。通过将url，查询的关键字，http报头，post数据等可以设置规定的长度，采用适当的格式，过滤或忽略部分内容等等。其次可以采取同源策略实现安全.



